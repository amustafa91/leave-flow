import{a as j}from"./chunk-TSVHZL5E.js";import{a as F}from"./chunk-YGA4NT5E.js";import{b as N,d as A,e as T,h as D,j as k,k as w,r as G,t as B}from"./chunk-6V3UBU2M.js";import"./chunk-QLOJGE75.js";import"./chunk-6R7RKMAX.js";import"./chunk-A5WJPGEG.js";import{$a as S,Ca as x,Fb as I,Ga as P,Ka as u,Qa as b,Ua as s,Xa as t,Ya as e,Za as m,ab as _,ba as g,eb as i,fb as c,gb as h,na as v,ya as r}from"./chunk-DENDG36W.js";function V(l,n){l&1&&(t(0,"span",18),g(),t(1,"svg",24),m(2,"path",25),e(),i(3," Uploaded "),e())}function U(l,n){l&1&&i(0," Not uploaded ")}function O(l,n){l&1&&(t(0,"span",18),g(),t(1,"svg",24),m(2,"path",25),e(),i(3," Uploaded "),e())}function R(l,n){l&1&&i(0," Not uploaded ")}function z(l,n){if(l&1&&(t(0,"div",20),i(1),e()),l&2){let a=_();r(),h(" ",a.message()," ")}}function H(l,n){if(l&1&&(t(0,"div",21),i(1),e()),l&2){let a=_();r(),h(" ",a.error()," ")}}function L(l,n){l&1&&i(0," Saving... ")}function q(l,n){l&1&&i(0," Save Changes ")}var M=class l{constructor(n,a,o){this.fb=n;this.employeeService=a;this.authService=o;this.form=this.fb.group({phone:[""],address:[""],emergencyContact:[""],bankAccount:[""]})}form;user=v(null);loading=!1;message=v("");error=v("");passportFile=null;nationalIdFile=null;ngOnInit(){this.employeeService.getAll().subscribe({});let n=this.authService.user();n&&this.employeeService.getById(n.id).subscribe({next:a=>{this.user.set(a),this.patchForm(a)}})}patchForm(n){}onPassportSelected(n){this.passportFile=n.target.files[0]}onNationalIdSelected(n){this.nationalIdFile=n.target.files[0]}onSubmit(){this.loading=!0,this.message.set(""),this.error.set(""),this.employeeService.updateProfile(this.form.value,this.passportFile||void 0,this.nationalIdFile||void 0).subscribe({next:n=>{this.loading=!1,this.message.set("Profile updated successfully!"),this.authService.updateUser(n),this.user.set(n),this.form.reset()},error:n=>{this.loading=!1,this.error.set(n.error?.message||"Failed to update profile")}})}static \u0275fac=function(a){return new(a||l)(x(G),x(j),x(F))};static \u0275cmp=P({type:l,selectors:[["app-profile"]],decls:68,vars:11,consts:[[1,"max-w-3xl","animate-fadeIn"],[1,"text-2xl","font-bold","text-[var(--text-primary)]","mb-6"],[1,"card","space-y-8"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","pb-6","border-b","border-[var(--border)]"],[1,"block","text-sm","font-medium","text-[var(--text-secondary)]","mb-1"],[1,"text-[var(--text-primary)]","font-medium"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"block","text-sm","font-medium","text-[var(--text-primary)]","mb-1.5"],["type","text","formControlName","phone",1,"input"],[1,"md:col-span-2"],["formControlName","address","rows","2",1,"input","resize-none"],["type","text","formControlName","emergencyContact","placeholder","Name & Phone",1,"input"],["type","text","formControlName","bankAccount",1,"input"],[1,"space-y-4","pt-4","border-t","border-[var(--border)]"],[1,"font-medium","text-[var(--text-primary)]"],[1,"flex","items-center","justify-between","p-4","rounded-lg","bg-[var(--surface)]","border","border-[var(--border)]"],[1,"text-xs","text-[var(--text-secondary)]"],[1,"text-emerald-600","flex","items-center","gap-1"],["type","file",1,"text-sm","text-[var(--text-secondary)]",3,"change"],[1,"p-4","rounded-lg","bg-emerald-50","text-emerald-700","text-sm"],[1,"p-4","rounded-lg","bg-red-50","text-red-700","text-sm"],[1,"flex","justify-end","pt-4"],["type","submit",1,"btn","btn-primary","min-w-[120px]",3,"disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"]],template:function(a,o){if(a&1&&(t(0,"div",0)(1,"h1",1),i(2,"My Profile"),e(),t(3,"div",2)(4,"div",3)(5,"div")(6,"label",4),i(7,"Full Name"),e(),t(8,"div",5),i(9),e()(),t(10,"div")(11,"label",4),i(12,"Email"),e(),t(13,"div",5),i(14),e()(),t(15,"div")(16,"label",4),i(17,"Department"),e(),t(18,"div",5),i(19),e()(),t(20,"div")(21,"label",4),i(22,"Role"),e(),t(23,"div",5),i(24),e()()(),t(25,"form",6),S("ngSubmit",function(){return o.onSubmit()}),t(26,"div",7)(27,"div")(28,"label",8),i(29,"Phone Number"),e(),m(30,"input",9),e(),t(31,"div",10)(32,"label",8),i(33,"Address"),e(),m(34,"textarea",11),e(),t(35,"div",10)(36,"label",8),i(37,"Emergency Contact"),e(),m(38,"input",12),e(),t(39,"div",10)(40,"label",8),i(41,"Bank Account (IBAN)"),e(),m(42,"input",13),e()(),t(43,"div",14)(44,"h3",15),i(45,"Identity Documents"),e(),t(46,"div",16)(47,"div")(48,"div",15),i(49,"Passport Copy"),e(),t(50,"div",17),u(51,V,4,0,"span",18)(52,U,1,0),e()(),t(53,"input",19),S("change",function(d){return o.onPassportSelected(d)}),e()(),t(54,"div",16)(55,"div")(56,"div",15),i(57,"National ID Copy"),e(),t(58,"div",17),u(59,O,4,0,"span",18)(60,R,1,0),e()(),t(61,"input",19),S("change",function(d){return o.onNationalIdSelected(d)}),e()()(),u(62,z,2,1,"div",20)(63,H,2,1,"div",21),t(64,"div",22)(65,"button",23),u(66,L,1,0)(67,q,1,0),e()()()()()),a&2){let p,d,y,f,C,E;r(9),c((p=o.user())==null?null:p.fullName),r(5),c((d=o.user())==null?null:d.email),r(5),c(((y=o.user())==null?null:y.department)||"-"),r(5),c(((f=o.user())==null?null:f.role)===3?"Super Admin":((f=o.user())==null?null:f.role)===2?"HR Admin":"Employee"),r(),b("formGroup",o.form),r(26),s((C=o.user())!=null&&C.passportDocumentPath?51:52),r(8),s((E=o.user())!=null&&E.nationalIdDocumentPath?59:60),r(3),s(o.message()?62:-1),r(),s(o.error()?63:-1),r(2),b("disabled",o.loading||o.form.invalid),r(),s(o.loading?66:67)}},dependencies:[I,B,D,N,A,T,k,w],encapsulation:2})};export{M as ProfileComponent};
