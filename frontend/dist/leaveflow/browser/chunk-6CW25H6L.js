import{a as U}from"./chunk-YGA4NT5E.js";import{b as B,d as Y,g as O,l as $,m as j,n as G,s as J}from"./chunk-6V3UBU2M.js";import"./chunk-QLOJGE75.js";import"./chunk-6R7RKMAX.js";import{a as D}from"./chunk-A5WJPGEG.js";import{$ as c,$a as y,Bb as A,Ca as v,Db as P,Fb as F,Ga as M,Ka as h,Kb as L,Pa as V,Qa as u,Ta as w,Ua as H,Va as I,Wa as k,Xa as t,Ya as i,Za as T,_a as f,aa as p,ab as m,ba as E,eb as l,fb as C,gb as S,ib as _,jb as g,kb as x,mb as N,na as b,nb as W,ya as d}from"./chunk-DENDG36W.js";var q=(s,a)=>a.id;function z(s,a){if(s&1){let e=f();t(0,"div",24)(1,"button",25),y("click",function(){c(e);let o=m();return p(o.syncHolidays())}),E(),t(2,"svg",26),T(3,"path",27),i(),l(4," Sync with Global Calendar "),i()()}if(s&2){let e=m();d(),u("disabled",e.isLoading())}}function Q(s,a){if(s&1){let e=f();t(0,"div",28)(1,"h3",29),l(2,"Add Custom Holiday"),i(),t(3,"div",30)(4,"div")(5,"label",6),l(6,"Date"),i(),t(7,"input",31),x("ngModelChange",function(o){c(e);let r=m();return g(r.newHoliday.date,o)||(r.newHoliday.date=o),p(o)}),i()(),t(8,"div",32)(9,"label",6),l(10,"Name"),i(),t(11,"input",33),x("ngModelChange",function(o){c(e);let r=m();return g(r.newHoliday.name,o)||(r.newHoliday.name=o),p(o)}),i()(),t(12,"button",34),y("click",function(){c(e);let o=m();return p(o.addHoliday())}),l(13,"Add Holiday"),i()()()}if(s&2){let e=m();d(7),_("ngModel",e.newHoliday.date),d(4),_("ngModel",e.newHoliday.name)}}function R(s,a){s&1&&(t(0,"th",20),l(1,"Actions"),i())}function X(s,a){if(s&1){let e=f();t(0,"td",35)(1,"input",36),x("ngModelChange",function(o){c(e);let r=m(2);return g(r.editHoliday.date,o)||(r.editHoliday.date=o),p(o)}),i()(),t(2,"td",35)(3,"input",37),x("ngModelChange",function(o){c(e);let r=m(2);return g(r.editHoliday.name,o)||(r.editHoliday.name=o),p(o)}),i()(),t(4,"td",35)(5,"input",37),x("ngModelChange",function(o){c(e);let r=m(2);return g(r.editHoliday.localName,o)||(r.editHoliday.localName=o),p(o)}),i()(),t(6,"td",38)(7,"span"),l(8),i()(),t(9,"td",39)(10,"button",40),y("click",function(){c(e);let o=m(2);return p(o.saveEdit())}),l(11,"Save"),i(),t(12,"button",41),y("click",function(){c(e);let o=m(2);return p(o.cancelEdit())}),l(13,"Cancel"),i()()}if(s&2){let e=m().$implicit,n=m();d(),_("ngModel",n.editHoliday.date),d(2),_("ngModel",n.editHoliday.name),d(2),_("ngModel",n.editHoliday.localName),d(2),w(e.isCustom||e.isModified?"badge-amber":"badge-blue"),d(),S(" ",e.isCustom?"Custom":e.isModified?"Official (Edited)":"Official"," ")}}function Z(s,a){if(s&1){let e=f();t(0,"td",45)(1,"button",46),y("click",function(){c(e);let o=m(2).$implicit,r=m();return p(r.startEdit(o))}),l(2,"Edit"),i(),t(3,"button",47),y("click",function(){c(e);let o=m(2).$implicit,r=m();return p(r.deleteHoliday(o.id))}),l(4,"Delete"),i()()}}function ee(s,a){if(s&1&&(t(0,"td",38),l(1),N(2,"date"),i(),t(3,"td",42),l(4),i(),t(5,"td",43),l(6),i(),t(7,"td",38)(8,"span"),l(9),i()(),h(10,Z,5,0,"td",44)),s&2){let e=m().$implicit,n=m();d(),C(W(2,7,e.date)),d(3),C(e.name),d(2),C(e.localName||"-"),d(2),w(e.isCustom||e.isModified?"badge-amber":"badge-blue"),d(),S(" ",e.isCustom?"Custom":e.isModified?"Official (Edited)":"Official"," "),d(),u("ngIf",n.hasAdminPrivileges)}}function te(s,a){if(s&1&&(t(0,"tr",23),h(1,X,14,6)(2,ee,11,9),i()),s&2){let e=a.$implicit,n=m();d(),H(n.editingId===e.id?1:2)}}function ie(s,a){if(s&1&&(t(0,"tr")(1,"td",48),l(2,"No holidays found for this selection."),i()()),s&2){let e=m();d(),V("colspan",e.hasAdminPrivileges?5:4)}}var K=class s{constructor(a,e){this.http=a;this.authService=e;this.loadHolidays()}holidays=b([]);selectedCountry="AE";selectedYear=new Date().getFullYear();isLoading=b(!1);newHoliday={date:"",name:""};editingId=null;editHoliday={date:"",name:"",localName:""};apiUrl=`${D.apiUrl}/holidays`;get hasAdminPrivileges(){return this.authService.isAdmin()}loadHolidays(){this.isLoading.set(!0),this.http.get(`${this.apiUrl}/${this.selectedCountry}/${this.selectedYear}`).subscribe({next:a=>{this.holidays.set(a),this.isLoading.set(!1)},error:()=>this.isLoading.set(!1)})}syncHolidays(){confirm(`Are you sure you want to sync official holidays for ${this.selectedCountry} ${this.selectedYear}?`)&&(this.isLoading.set(!0),this.http.post(`${this.apiUrl}/sync/${this.selectedCountry}/${this.selectedYear}`,{}).subscribe({next:a=>{this.holidays.set(a),this.isLoading.set(!1),alert(`Successfully synced ${a.length} holidays!`)},error:a=>{alert("Failed to sync: "+(a.error?.message||a.message)),this.isLoading.set(!1)}}))}addHoliday(){!this.newHoliday.date||!this.newHoliday.name||this.http.post(this.apiUrl,{date:this.newHoliday.date,name:this.newHoliday.name,countryCode:this.selectedCountry}).subscribe({next:a=>{this.holidays.update(e=>[...e,a].sort((n,o)=>n.date.localeCompare(o.date))),this.newHoliday={date:"",name:""}},error:a=>alert(a.message)})}startEdit(a){this.editingId=a.id,this.editHoliday={date:a.date.substring(0,10),name:a.name,localName:a.localName||""}}cancelEdit(){this.editingId=null}saveEdit(){this.editingId&&this.http.put(`${this.apiUrl}/${this.editingId}`,{date:this.editHoliday.date,name:this.editHoliday.name,localName:this.editHoliday.localName,countryCode:this.selectedCountry}).subscribe({next:a=>{this.holidays.update(e=>e.map(n=>n.id===this.editingId?a:n).sort((n,o)=>n.date.localeCompare(o.date))),this.editingId=null},error:a=>alert("Failed to update: "+(a.error?.message||a.message))})}deleteHoliday(a){confirm("Delete this holiday?")&&this.http.delete(`${this.apiUrl}/${a}`).subscribe({next:()=>{this.holidays.update(e=>e.filter(n=>n.id!==a))}})}static \u0275fac=function(e){return new(e||s)(v(L),v(U))};static \u0275cmp=M({type:s,selectors:[["app-holidays"]],decls:52,vars:9,consts:[[1,"animate-fadeIn","space-y-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-[var(--text-primary)]"],["class","flex gap-3",4,"ngIf"],[1,"flex","gap-4","bg-white","p-4","rounded-xl","shadow-sm","border","border-[var(--border)]"],[1,"flex-1"],[1,"block","text-sm","font-medium","text-[var(--text-secondary)]","mb-1"],[1,"input-field","w-full",3,"ngModelChange","change","ngModel"],["value","AE"],["value","IN"],["value","PK"],["value","JO"],["value","EG"],["value","US"],["value","GB"],[3,"value"],["class","bg-white p-6 rounded-xl shadow-sm border border-[var(--border)]",4,"ngIf"],[1,"bg-white","rounded-xl","shadow-sm","border","border-[var(--border)]","overflow-hidden"],[1,"w-full","text-left"],[1,"bg-gray-50","border-b","border-[var(--border)]"],[1,"p-4","font-semibold","text-[var(--text-secondary)]"],["class","p-4 font-semibold text-[var(--text-secondary)]",4,"ngIf"],[1,"divide-y","divide-[var(--border)]"],[1,"hover:bg-gray-50","transition-colors"],[1,"flex","gap-3"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-colors","flex","items-center","gap-2",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"bg-white","p-6","rounded-xl","shadow-sm","border","border-[var(--border)]"],[1,"font-bold","text-lg","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","items-end"],["type","date",1,"input-field","w-full",3,"ngModelChange","ngModel"],[1,"md:col-span-2"],["type","text","placeholder","E.g. Company Foundation Day",1,"input-field","w-full",3,"ngModelChange","ngModel"],[1,"btn-primary","w-full",3,"click"],[1,"p-3"],["type","date",1,"input-field","w-full","text-sm",3,"ngModelChange","ngModel"],["type","text",1,"input-field","w-full","text-sm",3,"ngModelChange","ngModel"],[1,"p-4"],[1,"p-3","flex","gap-2"],[1,"text-green-600","hover:text-green-800","font-medium",3,"click"],[1,"text-gray-500","hover:text-gray-700",3,"click"],[1,"p-4","font-medium"],[1,"p-4","text-gray-500"],["class","p-4 flex gap-3",4,"ngIf"],[1,"p-4","flex","gap-3"],[1,"text-blue-600","hover:text-blue-800",3,"click"],[1,"text-red-500","hover:text-red-700",3,"click"],[1,"p-8","text-center","text-gray-500"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"div",1)(2,"h1",2),l(3,"Public Holidays"),i(),h(4,z,5,1,"div",3),i(),t(5,"div",4)(6,"div",5)(7,"label",6),l(8,"Country"),i(),t(9,"select",7),x("ngModelChange",function(r){return g(n.selectedCountry,r)||(n.selectedCountry=r),r}),y("change",function(){return n.loadHolidays()}),t(10,"option",8),l(11,"United Arab Emirates"),i(),t(12,"option",9),l(13,"India"),i(),t(14,"option",10),l(15,"Pakistan"),i(),t(16,"option",11),l(17,"Jordan"),i(),t(18,"option",12),l(19,"Egypt"),i(),t(20,"option",13),l(21,"United States"),i(),t(22,"option",14),l(23,"United Kingdom"),i()()(),t(24,"div",5)(25,"label",6),l(26,"Year"),i(),t(27,"select",7),x("ngModelChange",function(r){return g(n.selectedYear,r)||(n.selectedYear=r),r}),y("change",function(){return n.loadHolidays()}),t(28,"option",15),l(29,"2024"),i(),t(30,"option",15),l(31,"2025"),i(),t(32,"option",15),l(33,"2026"),i()()()(),h(34,Q,14,2,"div",16),t(35,"div",17)(36,"table",18)(37,"thead",19)(38,"tr")(39,"th",20),l(40,"Date"),i(),t(41,"th",20),l(42,"Holiday Name"),i(),t(43,"th",20),l(44,"Local Name"),i(),t(45,"th",20),l(46,"Source"),i(),h(47,R,2,0,"th",21),i()(),t(48,"tbody",22),I(49,te,3,1,"tr",23,q),h(51,ie,3,1,"tr"),i()()()()),e&2&&(d(4),u("ngIf",n.hasAdminPrivileges),d(5),_("ngModel",n.selectedCountry),d(18),_("ngModel",n.selectedYear),d(),u("value",2024),d(2),u("value",2025),d(2),u("value",2026),d(2),u("ngIf",n.hasAdminPrivileges),d(13),u("ngIf",n.hasAdminPrivileges),d(2),k(n.holidays()),d(2),H(n.holidays().length===0?51:-1))},dependencies:[F,A,P,J,j,G,B,$,Y,O],encapsulation:2})};export{K as HolidaysComponent};
