import{a as N}from"./chunk-YGA4NT5E.js";import"./chunk-QLOJGE75.js";import{e as j}from"./chunk-6R7RKMAX.js";import{a as $}from"./chunk-3CDIZWEL.js";import{a as P}from"./chunk-A5WJPGEG.js";import{$ as w,$a as q,Ca as y,Db as B,Eb as F,Fb as A,Ga as T,Ka as p,Kb as M,Ra as b,Ta as k,Ua as u,Va as g,Wa as _,Xa as t,Ya as i,Za as x,_a as H,aa as L,ab as m,ba as E,ca as I,eb as a,fb as v,gb as d,hb as R,mb as s,na as h,nb as C,ob as f,ya as r}from"./chunk-DENDG36W.js";var D=(o,n)=>n.id;function U(o,n){o&1&&(t(0,"div",12),a(1," Loading balances... "),i())}function G(o,n){if(o&1&&(t(0,"span",31),a(1),i()),o&2){let e=m().$implicit;r(),d("Accrued: ",e.accruedDays,"")}}function z(o,n){if(o&1&&(t(0,"div",19)(1,"div",21)(2,"div",22),x(3,"div",23),t(4,"span",24),a(5),i()(),t(6,"span",25),a(7),s(8,"number"),i()(),t(9,"div",26),a(10),s(11,"number"),i(),t(12,"div",27),x(13,"div",28),i(),t(14,"div",29)(15,"span"),a(16),i(),t(17,"span",30)(18,"span"),a(19),i(),p(20,G,2,1,"span",31),i()()()),o&2){let e=n.$implicit;r(3),b("background-color",e.leaveTypeColor),r(2),v(e.leaveTypeName),r(),b("color",e.leaveTypeColor),r(),d(" ",f(8,14,e.remainingDays,"1.0-2")," "),r(3),d(" of ",f(11,17,e.totalDays,"1.0-2")," days remaining "),r(3),b("width",e.remainingDays/e.totalDays*100,"%")("background-color",e.leaveTypeColor),r(3),d("Used: ",e.usedDays,""),r(3),d("Pending: ",e.pendingHours,"h"),r(),u(e.accruedDays?20:-1)}}function W(o,n){o&1&&(t(0,"div",20),a(1," No leave balances found. Contact HR to assign leave types. "),i())}function Y(o,n){if(o&1&&g(0,z,21,20,"div",19,D,!1,W,2,0,"div",20),o&2){let e=m();_(e.balances())}}function J(o,n){o&1&&(t(0,"div",14),a(1,"Loading..."),i())}function K(o,n){o&1&&(t(0,"span",38),a(1,"Custom"),i())}function Q(o,n){if(o&1&&(t(0,"div",32)(1,"div",33)(2,"span",34),a(3),s(4,"date"),i(),t(5,"span",35),a(6),s(7,"date"),i()(),t(8,"div",36)(9,"div",24),a(10),i(),t(11,"div",37),a(12),s(13,"date"),i()(),p(14,K,2,0,"span",38),i()),o&2){let e=n.$implicit;r(3),v(f(4,5,e.date,"MMM")),r(3),v(f(7,8,e.date,"d")),r(4),v(e.name),r(2),v(f(13,11,e.date,"EEEE")),r(2),u(e.isCustom?14:-1)}}function X(o,n){if(o&1&&(t(0,"div",15),g(1,Q,15,14,"div",32,D),i()),o&2){let e=m();r(),_(e.upcomingHolidays())}}function Z(o,n){o&1&&(t(0,"div",16),E(),t(1,"svg",39),x(2,"path",40),i(),a(3," No upcoming holidays "),i())}function ee(o,n){if(o&1){let e=H();t(0,"button",50),q("click",function(){w(e);let c=m().$implicit,S=m(2);return L(S.cancelRequest(c.id))}),a(1," Cancel "),i()}}function te(o,n){if(o&1&&(t(0,"tr",44)(1,"td",45),a(2),i(),t(3,"td",46),a(4),s(5,"date"),i(),t(6,"td",47)(7,"div",22),x(8,"div",48),t(9,"span",24),a(10),i()()(),t(11,"td",46),a(12),s(13,"date"),s(14,"date"),i(),t(15,"td",46),a(16),i(),t(17,"td",47)(18,"span"),a(19),i()(),t(20,"td",46),a(21),i(),t(22,"td",47),p(23,ee,2,0,"button",49),i()()),o&2){let e=n.$implicit,l=m(2);r(2),d(" ",e.employeeName," "),r(2),d(" ",C(5,13,e.createdAt)," "),r(4),b("background-color",e.leaveTypeColor),r(2),v(e.leaveTypeName),r(2),R(" ",C(13,15,e.startDate)," - ",C(14,17,e.endDate)," "),r(4),d(" ",e.isFullDay?e.totalDays+" days":e.leaveHours+" hours"," "),r(2),k(l.getStatusClass(e.status)),r(),d(" ",l.getStatusLabel(e.status)," "),r(2),d(" ",e.approverName||"-"," "),r(2),u(l.canCancel(e)?23:-1)}}function ie(o,n){if(o&1&&(t(0,"div",17)(1,"table",41)(2,"thead")(3,"tr",42)(4,"th",43),a(5,"Employee"),i(),t(6,"th",43),a(7,"Applied On"),i(),t(8,"th",43),a(9,"Type"),i(),t(10,"th",43),a(11,"Dates"),i(),t(12,"th",43),a(13,"Days"),i(),t(14,"th",43),a(15,"Status"),i(),t(16,"th",43),a(17,"Approver"),i(),t(18,"th",43),a(19,"Actions"),i()()(),t(20,"tbody"),g(21,te,24,19,"tr",44,D),i()()()),o&2){let e=m();r(21),_(e.requests().slice(0,5))}}function ne(o,n){o&1&&(t(0,"div",18),a(1," No leave requests yet. "),t(2,"a",51),a(3,"Request one!"),i()())}var V=class o{constructor(n,e,l){this.authService=n;this.leaveService=e;this.http=l}balances=h([]);requests=h([]);upcomingHolidays=h([]);balancesLoading=!0;holidaysLoading=!0;ngOnInit(){this.loadData(),this.loadHolidays()}loadData(){this.balancesLoading=!0,this.leaveService.getMyBalances().subscribe({next:n=>{this.balances.set(n),this.balancesLoading=!1},error:n=>{console.error("Failed to load balances",n),this.balancesLoading=!1}}),this.leaveService.getMyRequests().subscribe({next:n=>this.requests.set(n),error:n=>console.error("Failed to load requests",n)})}loadHolidays(){this.holidaysLoading=!0;let n=this.authService.user()?.countryCode||"AE",e=new Date().getFullYear();this.http.get(`${P.apiUrl}/holidays/${n}/${e}`).subscribe({next:l=>{let c=new Date;c.setHours(0,0,0,0);let S=l.filter(O=>new Date(O.date)>=c).slice(0,5);this.upcomingHolidays.set(S),this.holidaysLoading=!1},error:()=>{this.holidaysLoading=!1}})}getStatusClass(n){let e="badge ";switch(n){case 0:return e+"badge-pending";case 1:return e+"badge-approved";case 2:return e+"badge-rejected";case 3:return e+"badge-cancelled";default:return e}}getStatusLabel(n){switch(n){case 0:return"Pending";case 1:return"Approved";case 2:return"Rejected";case 3:return"Cancelled";default:return"Unknown"}}canCancel(n){return n.status===0?!0:n.status===1?new Date(n.startDate)>new Date:!1}cancelRequest(n){confirm("Are you sure you want to cancel this leave request?")&&this.leaveService.cancelRequest(n).subscribe({next:()=>{this.loadData()},error:e=>console.error("Failed to cancel request",e)})}static \u0275fac=function(e){return new(e||o)(y(N),y($),y(M))};static \u0275cmp=T({type:o,selectors:[["app-dashboard"]],decls:31,vars:4,consts:[[1,"animate-fadeIn"],[1,"mb-8"],[1,"text-2xl","font-bold","text-[var(--text-primary)]"],[1,"text-[var(--text-secondary)]","mt-1"],[1,"flex","gap-3","mb-8"],["routerLink","/leave-request",1,"btn","btn-primary"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6","mb-8"],[1,"lg:col-span-2"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"col-span-2","text-center","py-8","text-[var(--text-secondary)]","animate-pulse"],[1,"card"],[1,"text-center","py-4","text-[var(--text-secondary)]","animate-pulse"],[1,"space-y-3"],[1,"text-center","py-6","text-[var(--text-secondary)]"],[1,"overflow-x-auto"],[1,"text-center","py-8","text-[var(--text-secondary)]"],[1,"card","hover:shadow-md","transition-shadow"],[1,"col-span-2","text-center","py-8","text-[var(--text-secondary)]"],[1,"flex","items-center","justify-between","mb-3"],[1,"flex","items-center","gap-2"],[1,"w-3","h-3","rounded-full"],[1,"font-medium","text-[var(--text-primary)]"],[1,"text-2xl","font-bold"],[1,"text-sm","text-[var(--text-secondary)]","mb-2"],[1,"h-2","bg-gray-100","rounded-full","overflow-hidden"],[1,"h-full","rounded-full","transition-all","duration-500"],[1,"flex","justify-between","text-xs","text-[var(--text-secondary)]","mt-2"],[1,"flex","flex-col","items-end"],["title","Earned pro-rata based on days worked this year",1,"text-emerald-600","font-medium"],[1,"flex","items-center","gap-3","p-3","bg-gradient-to-r","from-amber-50","to-orange-50","rounded-lg","border","border-amber-100"],[1,"flex","flex-col","items-center","justify-center","w-12","h-12","bg-white","rounded-lg","shadow-sm"],[1,"text-xs","font-medium","text-amber-600"],[1,"text-lg","font-bold","text-amber-700"],[1,"flex-1"],[1,"text-xs","text-[var(--text-secondary)]"],[1,"text-xs","px-2","py-0.5","bg-amber-100","text-amber-700","rounded"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","mx-auto","mb-2","text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","1.5","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"w-full","text-left","text-sm"],[1,"text-[var(--text-secondary)]","border-b","border-[var(--border)]"],[1,"pb-3","font-medium"],[1,"border-b","border-[var(--border)]","last:border-0","hover:bg-[var(--surface-hover)]"],[1,"py-3","font-medium","text-[var(--text-primary)]"],[1,"py-3","text-[var(--text-secondary)]"],[1,"py-3"],[1,"w-2","h-2","rounded-full"],[1,"text-red-600","hover:text-red-800","text-sm","font-medium","transition-colors"],[1,"text-red-600","hover:text-red-800","text-sm","font-medium","transition-colors",3,"click"],["routerLink","/leave-request",1,"text-emerald-600","hover:underline"]],template:function(e,l){if(e&1&&(t(0,"div",0)(1,"div",1)(2,"h1",2),a(3),i(),t(4,"p",3),a(5,"Here's your leave overview"),i()(),t(6,"div",4)(7,"a",5),E(),t(8,"svg",6),x(9,"path",7),i(),a(10," Request Leave "),i()(),I(),t(11,"div",8)(12,"div",9)(13,"h2",10),a(14,"Leave Balances"),i(),t(15,"div",11),p(16,U,2,0,"div",12)(17,Y,3,1),i()(),t(18,"div")(19,"h2",10),a(20,"Upcoming Holidays \u{1F389}"),i(),t(21,"div",13),p(22,J,2,0,"div",14)(23,X,3,0,"div",15)(24,Z,4,0,"div",16),i()()(),t(25,"div")(26,"h2",10),a(27,"Recent Requests"),i(),t(28,"div",13),p(29,ie,23,0,"div",17)(30,ne,4,0,"div",18),i()()()),e&2){let c;r(3),d(" Welcome back, ",(c=l.authService.user())==null?null:c.firstName,"! \u{1F44B} "),r(13),u(l.balancesLoading?16:17),r(6),u(l.holidaysLoading?22:l.upcomingHolidays().length>0?23:24),r(7),u(l.requests().length>0?29:30)}},dependencies:[A,F,B,j],encapsulation:2})};export{V as DashboardComponent};
